<dom-module id="nuxeo-dam-share-dialog">
  <template>
    <style>
      :host {
        display: inline-block;
      }

      paper-dialog {
        min-width: 480px;
      }

      paper-dialog .buttons {
        @apply(--layout-start-justified);
        background-color: var(--nuxeo-dialog-buttons-bar, white);
        margin-top: 2em;
      }
    </style>

    <paper-dialog id="dialog" with-backdrop>
      <h2>[[i18n('shareButton.dialog.heading')]]</h2>
      <paper-input id="permalink" label="[[i18n('shareButton.copy.label', document.properties.dc:title)]]"
                   value="[[_buildPermalink(document)]]"
                   autofocus
                   readonly>
      </paper-input>
      <div class="buttons">
        <paper-button dialog-dismiss>[[i18n('shareButton.dialog.close')]]</paper-button>
      </div>
    </paper-dialog>

  </template>

  <script>
    Polymer({
      is: 'nuxeo-dam-share-dialog',
      behaviors: [Nuxeo.I18nBehavior, Nuxeo.FiltersBehavior],
      properties: {

        /**
         * Input document.
         */
        document: Object,

        /**
         * Icon to use (iconset_name:icon_name).
         */
        icon: {
          type: String,
          value: 'social:share'
        }
      },

      toggleDialog: function() {
        this._buildPermalink(this.document);
        this.$.dialog.toggle();
        this.$.permalink.inputElement.select();
      },

      _buildPermalink: function(document) {
        return document ? location.origin + location.pathname + '#!/doc/' + document.uid : '';
      }

    });
  </script>

</dom-module>
